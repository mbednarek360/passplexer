digraph d {

    // settings
    graph [fontsize=16 compound=true, splines=ortho];
    node [shape=rect fontsize=14, style=filled];

    // inputs
    subgraph cluster_input {

        // label
        label = "Input";

        // input nodes
        s [label = "Service"];
        u [label = "Username"];
        p [label = "Password"];


    }

    // hashes
    subgraph cluster_hash {

        // hash nodes
        uh [label = "BLAKE3"];
        ph [label = "BLAKE3"];

        // hash inputs
        // s -> {sh, uh}
        u -> {uh}
        p -> {ph}

        // interlace
        i [label = "Interlace"];
        uh -> i
        ph -> i

        // salt gen
        sg [label = "LE Bytes"];
        s -> sg;

        // final hash
        fh [label = "Keyed BLAKE3"];
        i -> fh
        sg -> fh;
    }

    // output
    subgraph cluster_output {

        // label
        label = "Output"
        labelloc="b"

        // encoding
        out [label = "Base 85"];
        fh -> out;
    }
}
